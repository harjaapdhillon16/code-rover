name: AutoCodeRover Workflow

on:
  issues:
    types: [opened]

jobs:
  run-autocoderover:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2

      - name: Install Dependencies
        run: npm install

      - name: Create Pull Request
        uses: actions/github-script@v5
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const { Octokit } = require("@octokit/rest");
            const octokit = new Octokit({
              auth: process.env.GITHUB_TOKEN
            });

            const { data: branch } = await octokit.rest.repos.createOrUpdateFileContents({
              owner: context.repo.owner,
              repo: context.repo.repo,
              path: 'README.md',
              message: 'Auto-generated changes based on issue',
              content: Buffer.from('Your patch content').toString('base64'),
              branch: 'automated-patch'
            });

            const { data: pullRequest } = await octokit.rest.pulls.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: 'Auto-generated PR based on issue',
              head: branch.name,
              base: 'master'
            });

            console.log(`Pull request created: ${pullRequest.html_url}`);
